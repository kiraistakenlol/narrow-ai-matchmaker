digraph ConceptualDataModel {
    rankdir=TB; // Top to Bottom layout
    node [shape=plain]; // Use plain shape for HTML-like labels

    User [label=<
        <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
            <TR><TD COLSPAN="2" BGCOLOR="lightblue">User</TD></TR>
            <TR><TD ALIGN="LEFT">id</TD><TD ALIGN="LEFT">string (PK)</TD></TR>
            <TR><TD ALIGN="LEFT">email</TD><TD ALIGN="LEFT">string</TD></TR>
            <TR><TD ALIGN="LEFT">auth_provider_id</TD><TD ALIGN="LEFT">string</TD></TR>
            <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD COLSPAN="2" BGCOLOR="lightgrey" ALIGN="CENTER">Authentication &amp; Account Info</TD></TR>
        </TABLE>
    >];

    Profile [label=<
        <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
            <TR><TD COLSPAN="2" BGCOLOR="lightblue">Profile</TD></TR>
            <TR><TD ALIGN="LEFT">user_id</TD><TD ALIGN="LEFT">string (FK)</TD></TR>
            <TR><TD ALIGN="LEFT">data</TD><TD ALIGN="LEFT">jsonb</TD></TR>
            <TR><TD ALIGN="LEFT">raw_input_ref</TD><TD ALIGN="LEFT">string</TD></TR>
            <TR><TD ALIGN="LEFT">embedding_updated_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD COLSPAN="2" BGCOLOR="lightgrey" ALIGN="CENTER">User's matchable data</TD></TR>
        </TABLE>
    >];

    Event [label=<
        <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
            <TR><TD COLSPAN="2" BGCOLOR="lightgreen">Event</TD></TR>
            <TR><TD ALIGN="LEFT">id</TD><TD ALIGN="LEFT">string (PK)</TD></TR>
            <TR><TD ALIGN="LEFT">name</TD><TD ALIGN="LEFT">string</TD></TR>
            <TR><TD ALIGN="LEFT">description</TD><TD ALIGN="LEFT">string</TD></TR>
            <TR><TD ALIGN="LEFT">start_date</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">end_date</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD COLSPAN="2" BGCOLOR="lightgrey" ALIGN="CENTER">Represents a specific event</TD></TR>
        </TABLE>
    >];

    EventParticipation [label=<
        <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
            <TR><TD COLSPAN="2" BGCOLOR="lightyellow">EventParticipation</TD></TR>
            <TR><TD ALIGN="LEFT">user_id</TD><TD ALIGN="LEFT">string (FK)</TD></TR>
            <TR><TD ALIGN="LEFT">event_id</TD><TD ALIGN="LEFT">string (FK)</TD></TR>
            <TR><TD ALIGN="LEFT">goals</TD><TD ALIGN="LEFT">jsonb</TD></TR>
            <TR><TD ALIGN="LEFT">context</TD><TD ALIGN="LEFT">text</TD></TR>
            <TR><TD ALIGN="LEFT">joined_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD ALIGN="LEFT">embedding_updated_at</TD><TD ALIGN="LEFT">timestamp</TD></TR>
            <TR><TD COLSPAN="2" BGCOLOR="lightgrey" ALIGN="CENTER">Links User to Event</TD></TR>
        </TABLE>
    >];

    // Relationships
    User -> Profile [label=" 1..1", style=dashed, arrowhead=none, arrowtail=none]; // Representing 1-to-1
    User -> EventParticipation [label=" 1..N", arrowhead=normal, arrowtail=crow]; // Crow's foot for N
    Event -> EventParticipation [label=" 1..N", arrowhead=normal, arrowtail=crow];
} 