# Matching Engine Flow
direction: down

# Define styles
styles: {
  data: {
    shape: cylinder
    style: {
      fill: "#fff2cc"
      stroke: "#d6b656"
      stroke-width: 1
    }
  }
  
  process: {
    shape: rectangle
    style: {
      fill: "#dae8fc"
      stroke: "#6c8ebf"
      stroke-width: 1
      border-radius: 5
    }
  }
  
  vector: {
    shape: rectangle
    style: {
      fill: "#e1d5e7"
      stroke: "#9673a6"
      stroke-width: 1
      border-radius: 5
    }
  }
  
  match: {
    shape: rectangle
    style: {
      fill: "#d5e8d4"
      stroke: "#82b366"
      stroke-width: 1
      border-radius: 5
    }
  }
  
  user: {
    shape: person
    style: {
      fill: "#f5f5f5"
      stroke: "#333"
      stroke-width: 2
    }
  }
}

# Define components
User: {
  class: user
  label: "New User"
}

UserProfile: {
  class: data
  label: "User Profile\nDatabase"
}

Vectorization: {
  class: process
  label: "Profile Vectorization"
}

GeneralVector: {
  class: vector
  label: "General Purpose Vector\n(Full Profile)"
}

GoalsVector: {
  class: vector
  label: "Goals Vector\n(Event Objectives)"
}

HobbiesVector: {
  class: vector
  label: "Hobbies Vector\n(Interests & Activities)"
}

VectorDB: {
  class: data
  label: "Vector Database"
}

MatchingProcess: {
  class: process
  label: "Matching Process"
}

ScoreCalculation: {
  class: process
  label: "Calculate Match Scores"
}

TopMatches: {
  class: match
  label: "Top 5 Matches"
}

# Define flow
User -> UserProfile: "Profile Data"
UserProfile -> Vectorization: "Triggers"
Vectorization -> GeneralVector: "Creates"
Vectorization -> GoalsVector: "Creates"
Vectorization -> HobbiesVector: "Creates"
GeneralVector -> VectorDB: "Stores"
GoalsVector -> VectorDB: "Stores"
HobbiesVector -> VectorDB: "Stores"
VectorDB -> MatchingProcess: "Query"
MatchingProcess -> ScoreCalculation: "Compare Vectors"
ScoreCalculation -> TopMatches: "Rank & Select"

# Add explanatory note
Note: |md
  ## Matching Process
  1. New user profile data is stored
  2. Profile triggers vectorization
  3. Profile is vectorized into multiple dimensions:
     - General purpose vector (full profile context)
     - Goals vector (event-specific objectives)
     - Hobbies vector (interests and activities)
  4. Vectors are stored for matching
  5. Matching process compares vectors to find best matches
|

Note.style: {
  fill: "#f5f5f5"
  stroke: "#333"
  stroke-width: 1
  border-radius: 5
} 